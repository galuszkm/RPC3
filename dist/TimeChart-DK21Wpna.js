import{j as r,r as a,u as d,T as h}from"./index.js";import{E as u}from"./index-B9mShMQm.js";const g=(t,e,i,n)=>`
    <div style="
      display: flex; 
      justify-content: space-between; 
      width: 100%;
      font-size: 13px;
    ">
      <span style="width: 240px; overflow: hidden; text-overflow: ellipsis; margin-right: 5px">${t} ${e}</span>
      <span style="width: 55px; text-align: right;">${i.toFixed(2)}</span>
      <span style="width: 55px; text-align: left; margin-left: 8px">${n?`${n}`:""}</span>
    </div>
  `,w=t=>{let e=`
    <div 
      style="
      font-size: 13px; 
      margin-bottom: 5px; 
      font-weight: bold
    ">
    Time: ${t[0].axisValue.toFixed(3)} s
    </div>
  `;return t.forEach(i=>{const n=i.seriesName.match(/\[(.*?)\]$/),x=n?n[1]:"",c=i.seriesName.replace(/\s*\[.*?\]$/,"");e+=g(i.marker,c,i.value[1],x)}),`<div style="padding: 5px; min-width: 250px;">${e}</div>`},p={title:{},legend:{show:!0,orient:"horizontal",left:20,top:0,itemGap:20,formatter:t=>t.length>33?t.substring(0,30)+"...":t},toolbox:{right:20,feature:{dataZoom:{yAxisIndex:!1},saveAsImage:{pixelRatio:2}}},tooltip:{show:!1,trigger:"axis",axisPointer:{type:"line"},formatter:w},grid:{left:60,right:30,top:50,bottom:80,containLabel:!0},dataZoom:[{type:"inside",xAxisIndex:[0]},{type:"slider",xAxisIndex:[0]}],xAxis:{type:"value",name:"Time (s)",nameLocation:"middle",nameGap:30,min:0,max:"dataMax",splitLine:{show:!1},nameTextStyle:{fontSize:14,fontFamily:"Inter var, sans-serif"},axisLabel:{fontSize:13,fontFamily:"Inter var, sans-serif",color:"#555"}},yAxis:{type:"value",name:"",nameLocation:"middle",nameGap:80,min:"dataMin",max:"dataMax",splitLine:{show:!0},nameTextStyle:{fontSize:14,fontFamily:"Inter var, sans-serif"},axisLabel:{fontSize:13,fontFamily:"Inter var, sans-serif",color:"#555",formatter:t=>t.toFixed(2)}},series:[]},y=t=>r.jsx("svg",{version:"1.1",className:"extra-toolbox-button-icon",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 122.88 122.88",...t,children:r.jsx("g",{children:r.jsx("path",{d:"M0.92,32.82l31.9-31.9C33.44,0.3,34.24,0,35.05,0c0.8,0,1.61,0.3,2.22,0.92l84.69,84.69c0.61,0.61,0.92,1.42,0.92,2.23 c0,0.8-0.31,1.6-0.92,2.21l-0.01,0.01l0.01,0.01l-31.9,31.9c-0.62,0.62-1.42,0.92-2.23,0.92c-0.8,0-1.61-0.3-2.23-0.92L0.92,37.27 C0.3,36.65,0,35.84,0,35.05C0,34.24,0.3,33.44,0.92,32.82L0.92,32.82z M105.32,77.15L90.84,91.63c-1.13,1.13-2.84,1.26-3.81,0.29 c-0.97-0.97-0.84-2.68,0.29-3.81l14.48-14.48L90.12,61.94l-6.86,6.85c-1.13,1.13-2.84,1.26-3.81,0.29 c-0.97-0.97-0.84-2.68,0.29-3.81l6.86-6.86L75.88,47.71L61.4,62.19c-1.13,1.13-2.84,1.26-3.81,0.29c-0.97-0.97-0.84-2.68,0.29-3.81 l14.48-14.48L61.09,32.91l-6.86,6.85c-1.13,1.13-2.84,1.26-3.81,0.29c-0.97-0.97-0.84-2.68,0.29-3.81l6.86-6.86L46.43,18.26 L31.95,32.74c-1.13,1.13-2.83,1.25-3.8,0.29c-0.97-0.97-0.84-2.67,0.29-3.8l14.48-14.48l-7.87-7.87L6.87,35.05l80.96,80.96 l28.17-28.17C102.8,74.62,118.53,90.36,105.32,77.15L105.32,77.15z"})})}),v=t=>{const e=t.value.length,i=new Float64Array(e*2);for(let n=0;n<e;n++)i[n*2]=n*t.dt,i[n*2+1]=t.value[n];return i};function I({resizeTrigger:t}){const e=a.useRef(null),i=a.useRef(null),[n,x]=a.useState(!1),{channels:c}=d();a.useEffect(()=>{let s;const l=()=>{s.dispatchAction({type:"dataZoom",start:0,end:100})};return e.current&&(s=e.current.getEchartsInstance(),window.addEventListener("resize",f),s.getZr()&&s.getZr().on("dblclick",l)),()=>{s&&(window.removeEventListener("resize",f),s.getZr()&&s.getZr().off("dblclick",l))}},[]),a.useEffect(()=>{if(e.current){const s=e.current.getEchartsInstance(),l=c.map(o=>{var m;return{type:"line",name:`${o.Name} - ${(m=o.filename)==null?void 0:m.split(".")[0]} [${o.Units}]`,dimensions:["x","y"],data:v(o),showSymbol:!1,large:!0,sampling:"lttb",silent:!0,lineStyle:{width:1}}});s.setOption({series:l,yAxis:{...p.yAxis,name:[...new Set(c.map(o=>o.Units))].map(o=>`[${o}]`).join(", ")},tooltip:{...p.tooltip,show:n}},{notMerge:!1,replaceMerge:["series"]})}},[c]),a.useEffect(()=>{e.current&&e.current.getEchartsInstance().setOption({tooltip:{...p.tooltip,show:n}})},[n]),a.useEffect(()=>{f()},[t]);function f(){if(e.current&&i.current){const s=e.current.getEchartsInstance(),l=i.current.getBoundingClientRect().height;s.resize({height:l})}}return r.jsxs("div",{className:"time-chart-wrapper",ref:i,children:[r.jsx(h,{target:".extra-toolbox-button-icon",className:"extra-toolbox-button-tooltip",content:"Toggle Pointer",position:"bottom"}),r.jsx(y,{width:"17",height:"17",className:"extra-toolbox-button-icon"+(n?" active":""),onClick:()=>x(s=>!s)}),r.jsx(u,{ref:e,option:p,className:"time-chart-container"})]})}export{I as default};
